webpackJsonp([1],{0:function(e,t){},"1BZb":function(e,t){},"3ihA":function(e,t){},"7zck":function(e,t){},"9pHl":function(e,t){},DoN8:function(e,t){},GUKl:function(e,t){},KXnz:function(e,t){},NHnr:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("7+uW"),i=r("3EgV"),a=r.n(i),s=r("DmT9"),o=r.n(s),c=r("hMcO"),l=r.n(c),u=(r("7zck"),{data:function(){return{drawer:!1,lang:[{title:"English",icon:"https://cdn.vuetifyjs.com/images/flags/us.png",locale:"en"},{title:"Русский",icon:"https://cdn.vuetifyjs.com/images/flags/ru.png",locale:"ru"}]}},computed:{error:function(){return this.$store.getters.error},isUserLoggedIn:function(){return this.$store.getters.isUserLoggedIn},user:function(){return this.$store.getters.user},links:function(){return this.isUserLoggedIn?(window.console.log(this.$vuetify.lang.current),[{title:this.$vuetify.t("$vuetify.navLinks.profile"),icon:"account_box",url:"/user"},{title:this.$vuetify.t("$vuetify.navLinks.newNote"),icon:"note_add",url:"/new"},{title:this.$vuetify.t("$vuetify.navLinks.myNotes"),icon:"list",url:"/list"},{title:this.$vuetify.t("$vuetify.navLinks.chat"),icon:"chat",url:"/chat"}]):[{title:this.$vuetify.t("$vuetify.navLinks.registration"),icon:"face",url:"/registration"},{title:this.$vuetify.t("$vuetify.navLinks.login"),icon:"lock",url:"/login"},{title:"Game",icon:"games",url:"/game"}]},currentLocaleIcon:function(){var e=this.$vuetify.lang.current;return this.lang.find(function(t){return t.locale===e}).icon}},methods:{closeError:function(){this.$store.dispatch("clearError")},onLogout:function(){this.$store.dispatch("logoutUser"),this.$router.push("/")},onChangeLang:function(e){this.$vuetify.lang.current=e.locale}}}),d={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-app",[r("v-navigation-drawer",{attrs:{app:"",temporary:""},model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[r("v-list",[e._l(e.links,function(t){return r("v-list-tile",{key:t.title,attrs:{to:t.url}},[r("v-list-tile-action",[r("v-icon",[e._v(e._s(t.icon))])],1),e._v(" "),r("v-list-tile-content",[r("v-list-tile-title",{domProps:{textContent:e._s(t.title)}}),e._v(" "),"Profile"===t.title?r("v-list-tile-sub-title",{domProps:{textContent:e._s(e.user.email)}}):e._e()],1)],1)}),e._v(" "),e.isUserLoggedIn?r("v-list-tile",{on:{click:e.onLogout}},[r("v-list-tile-action",[r("v-icon",[e._v("exit_to_app")])],1),e._v(" "),r("v-list-tile-content",[r("v-list-tile-title",{domProps:{textContent:e._s(e.$vuetify.t("$vuetify.navLinks.logout"))}})],1)],1):e._e()],2)],1),e._v(" "),r("v-toolbar",{attrs:{app:"",dark:"",color:"primary"}},[r("v-toolbar-side-icon",{staticClass:"hidden-md-and-up",on:{click:function(t){e.drawer=!e.drawer}}}),e._v(" "),r("v-toolbar-title",[r("router-link",{staticClass:"pointer",attrs:{to:"/",tag:"span"}},[e._v(e._s(e.$vuetify.t("$vuetify.appName")))])],1),e._v(" "),r("v-spacer"),e._v(" "),r("v-toolbar-items",{staticClass:"hidden-sm-and-down"},[r("v-menu",{attrs:{"offset-y":""}},[r("v-btn",{attrs:{slot:"activator",flat:""},slot:"activator"},[r("v-img",{attrs:{height:"26",contain:"",src:e.currentLocaleIcon}})],1),e._v(" "),r("v-list",e._l(e.lang,function(t,n){return r("v-list-tile",{key:n,on:{click:function(r){e.onChangeLang(t)}}},[r("v-img",{staticClass:"mr-3",attrs:{width:"24",src:t.icon}}),e._v(" "),r("v-list-tile-title",[e._v(e._s(t.title))])],1)}))],1),e._v(" "),e._l(e.links,function(t){return r("v-btn",{key:t.title,attrs:{flat:"",to:t.url}},[r("v-icon",{attrs:{left:""}},[e._v(e._s(t.icon))]),e._v("\n        "+e._s(t.title))],1)}),e._v(" "),e.isUserLoggedIn?r("v-btn",{attrs:{flat:""},on:{click:e.onLogout}},[r("v-icon",{attrs:{left:""}},[e._v("exit_to_app")]),e._v("\n        "+e._s(e.$vuetify.t("$vuetify.navLinks.logout"))+"\n      ")],1):e._e()],2)],1),e._v(" "),r("v-content",[r("router-view")],1),e._v(" "),e.error?[r("v-snackbar",{attrs:{"multi-line":!0,timeout:5e3,color:"error",value:!0},on:{input:e.closeError}},[e._v("\n      "+e._s(e.error)+"\n      "),r("v-btn",{attrs:{dark:"",flat:""},nativeOn:{click:function(t){return e.closeError(t)}}},[e._v("Close")])],1)]:e._e()],2)},staticRenderFns:[]};var v=r("VU/8")(u,d,!1,function(e){r("QSs0")},"data-v-8677e2c6",null).exports,f=r("/ocq"),p={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.loading?r("div",[r("v-container",[r("v-layout",{attrs:{row:""}},[r("v-flex",{staticClass:"text-xs-center",attrs:{xs12:""}},[r("v-progress-circular",{attrs:{size:150,color:"primary",indeterminate:""}})],1)],1)],1)],1):r("div",[e.notesWithPreview.length>0?r("v-container",{attrs:{fluid:""}},[r("v-layout",{attrs:{row:""}},[r("v-flex",{attrs:{xs12:""}},[r("v-carousel",e._l(e.notesWithPreview,function(t){return r("v-carousel-item",{key:t.id,attrs:{src:t.imageSrc},on:{click:function(r){e.onClickCarausel(t.id)}}})}))],1)],1)],1):e._e(),e._v(" "),r("v-container",{attrs:{"grid-list-lg":""}},[r("v-layout",{attrs:{row:"",wrap:""}},e._l(e.publicNotes,function(t){return r("v-flex",{key:t.id,attrs:{xs12:"",sm6:"",md4:"",lg4:"",xl3:""}},[r("v-card",[r("v-img",{attrs:{src:t.imageSrc||e.defaultImageSrc,height:"200px"}}),e._v(" "),r("v-card-text",{staticStyle:{"word-wrap":"break-word"}},[r("div",[r("h3",{staticClass:"headline mb-0"},[e._v(e._s(t.title))]),e._v(" "),r("div",[e._v(e._s(t.description))])])]),e._v(" "),r("v-card-actions",[r("v-spacer"),e._v(" "),r("v-btn",{staticClass:"primary",attrs:{raised:"",to:"/note/"+t.id}},[e._v(e._s(e.$vuetify.t("$vuetify.btn.open")))])],1)],1)],1)}))],1)],1)},staticRenderFns:[]};var m=r("VU/8")({data:function(){return{}},computed:{notesWithPreview:function(){return this.$store.getters.notesWithPreview},publicNotes:function(){return this.$store.getters.publicNotes},defaultImageSrc:function(){return this.$store.getters.defaultImageSrc},loading:function(){return this.$store.getters.loading}},methods:{onClickCarausel:function(e){this.$router.push("/note/"+e)}}},p,!1,function(e){r("KXnz")},"data-v-65ad8792",null).exports,h={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-dialog",{attrs:{"max-width":"1500px"},model:{value:e.modal,callback:function(t){e.modal=t},expression:"modal"}},[r("v-btn",{staticClass:"primary",attrs:{slot:"activator"},slot:"activator"},[e._v(e._s(e.$vuetify.t("$vuetify.btn.edit")))]),e._v(" "),r("v-card",[r("v-container",[r("v-layout",{attrs:{row:""}},[r("v-flex",{attrs:{xs12:"",lg10:"","offset-lg1":""}},[r("v-card-title",[r("h1",{staticClass:"text--primary"},[e._v(e._s(e.$vuetify.t("$vuetify.form.editNote")))])]),e._v(" "),r("v-form",{ref:"form",staticClass:"pa-3 pt-4",model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[r("v-text-field",{attrs:{name:"title",label:e.$vuetify.t("$vuetify.field.title"),type:"text"},model:{value:e.editedTitle,callback:function(t){e.editedTitle=t},expression:"editedTitle"}}),e._v(" "),r("v-textarea",{attrs:{name:"description",label:e.$vuetify.t("$vuetify.field.description"),type:"text","auto-grow":"",rows:"3"},model:{value:e.editedDescription,callback:function(t){e.editedDescription=t},expression:"editedDescription"}}),e._v(" "),r("v-textarea",{attrs:{name:"text",label:e.$vuetify.t("$vuetify.field.text"),type:"text",rows:"10"},model:{value:e.editedText,callback:function(t){e.editedText=t},expression:"editedText"}}),e._v(" "),r("v-switch",{attrs:{label:e.$vuetify.t("$vuetify.field.isPrivate"),color:"primary"},model:{value:e.editedIsPrivate,callback:function(t){e.editedIsPrivate=t},expression:"editedIsPrivate"}})],1),e._v(" "),r("v-card-actions",[r("v-spacer"),e._v(" "),r("v-btn",{attrs:{flat:""},on:{click:e.onCancel}},[e._v(e._s(e.$vuetify.t("$vuetify.btn.cancel")))]),e._v(" "),r("v-btn",{staticClass:"white--text",attrs:{raised:"",color:"primary",disabled:!e.valid||e.loading,loading:e.loading},on:{click:e.onSave}},[e._v(e._s(e.$vuetify.t("$vuetify.btn.save")))])],1)],1)],1)],1)],1)],1)},staticRenderFns:[]};var g=r("VU/8")({data:function(){return{modal:!1,editedTitle:this.note.title,editedDescription:this.note.description,editedText:this.note.text,editedIsPrivate:this.note.isPrivate,valid:!1}},methods:{onCancel:function(){this.editedTitle=this.note.title,this.editedDescription=this.note.description,this.editedText=this.note.text,this.editedIsPrivate=this.note.isPrivate,this.modal=!1},onSave:function(){var e=this;this.$store.dispatch("updateNote",{title:this.editedTitle,description:this.editedDescription,text:this.editedText,isPrivate:this.editedIsPrivate,id:this.note.id}).then(function(){e.modal=!1}).catch(function(){})}},props:["note"],computed:{loading:function(){return this.$store.getters.loading}}},h,!1,function(e){r("1BZb")},"data-v-6bf22265",null).exports,y=r("Zrlr"),k=r.n(y),w=r("wxAW"),x=r.n(w),_=r("Av7u"),$=r.n(_),b=function(){function e(){k()(this,e)}return x()(e,null,[{key:"encode",value:function(e,t){return $.a.AES.encrypt(e,t).toString()}},{key:"decode",value:function(e,t){return $.a.AES.decrypt(e,t).toString($.a.enc.Utf8)}}]),e}(),S={props:["id"],data:function(){return{decode:!1,key:"",decodedText:""}},computed:{note:function(){var e=this.id;window.console.log(e);var t=this.$store.getters.noteById(e);return t||(this.$store.dispatch("setError","a note was not found or insufficient access rights"),{})},defaultImageSrc:function(){return this.$store.getters.defaultImageSrc},loading:function(){return this.$store.getters.loading},user:function(){return this.$store.getters.user},text:function(){return this.note.text?this.decodedText.length>0?this.decodedText:this.note.text:""}},methods:{onDelete:function(){this.$store.dispatch("deleteNote",{id:this.note.id}).then(function(){}).catch(function(){}),this.$router.push("/list")},onDecode:function(){0===this.key.length?(this.decode=!this.decode,this.decodedText=""):(this.decode=!this.decode,this.decodedText=b.decode(this.note.text,this.key))}},components:{appEditNoteModal:g}},E={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",[e.note?r("v-layout",{attrs:{"justify-center":"",row:""}},[r("v-flex",{attrs:{xs12:"",sm10:"",md8:"",lg6:""}},[e.loading?r("v-flex",{staticClass:"text-xs-center",attrs:{xs12:""}},[r("v-progress-circular",{attrs:{size:150,color:"primary",indeterminate:""}})],1):r("v-card",[e.note.imageSrc?r("v-img",{attrs:{src:e.note.imageSrc,height:"300"}}):e._e(),e._v(" "),r("v-card-text",{staticStyle:{"word-wrap":"break-word"}},[r("h1",{staticClass:"text--primary py-3"},[e._v(e._s(e.note.title))]),e._v(" "),r("v-divider"),e._v(" "),r("h2",[e._v(e._s(e.note.description))]),e._v(" "),r("v-divider"),e._v(" "),r("p",[e._v(e._s(e.text))])],1),e._v(" "),r("v-card-actions",{attrs:{"pa-5":""}},[r("v-spacer"),e._v(" "),r("v-btn",{attrs:{flat:""},on:{click:e.onDecode}},[e._v("\n            "+e._s(e.decode?e.$vuetify.t("$vuetify.btn.decode"):e.$vuetify.t("$vuetify.btn.decodeQ"))+"\n          ")]),e._v(" "),e.user&&e.note.authorId===e.user.id?r("v-btn",{staticClass:"warning",attrs:{flat:""},on:{click:e.onDelete}},[e._v("\n            "+e._s(e.$vuetify.t("$vuetify.btn.delete"))+"\n          ")]):e._e(),e._v(" "),e.user&&e.note.authorId===e.user.id?r("app-edit-note-modal",{attrs:{note:e.note}}):e._e()],1),e._v(" "),r("v-layout",{attrs:{"justify-end":""}},[r("v-flex",{attrs:{xs11:"",sm8:"",md8:"",lg8:""}},[e.decode?r("v-text-field",{staticClass:"pa-0 ma-0",attrs:{clearable:"",name:"key",label:e.$vuetify.t("$vuetify.field.keyForDecode"),type:"text"},model:{value:e.key,callback:function(t){e.key=t},expression:"key"}}):e._e()],1)],1)],1)],1)],1):r("v-layout",{attrs:{row:""}},[r("v-flex",{staticClass:"text-xs-center",attrs:{xs12:""}},[r("v-progress-circular",{attrs:{indeterminate:"",color:"primary",size:200,width:20}})],1)],1)],1)},staticRenderFns:[]};var L=r("VU/8")(S,E,!1,function(e){r("DoN8")},"data-v-a62b225c",null).exports,N={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",{attrs:{"grid-list-lg":""}},[0!==e.myNotes.length?r("v-layout",{attrs:{row:"",wrap:""}},e._l(e.myNotes,function(t){return r("v-flex",{key:t.id,attrs:{xs12:"",sm6:"",md5:"",lg4:"",xl4:"","mb-3":""}},[r("v-card",[r("v-layout",{attrs:{row:""}},[r("v-flex",{attrs:{xs4:""}},[r("v-img",{attrs:{src:t.imageSrc||e.defaultImageSrc,height:"150px"}})],1),e._v(" "),r("v-flex",{attrs:{xs8:""}},[r("v-card-text",{staticStyle:{"word-wrap":"break-word"}},[r("h2",[e._v(" "+e._s(t.title||"Empty title"))]),e._v(" "),r("p",[e._v(e._s(t.description||"Empty description"))])]),e._v(" "),r("v-card-actions",[r("v-spacer"),e._v(" "),r("v-btn",{staticClass:"white--text",attrs:{color:"primary",to:"/note/"+t.id}},[e._v(e._s(e.$vuetify.t("$vuetify.btn.open")))])],1)],1)],1)],1)],1)})):0===e.myNotes.length?r("v-layout",[r("v-flex",{staticClass:"text-xs-center",attrs:{xs12:""}},[r("h1",{staticClass:"text--primary"},[e._v(e._s(e.$vuetify.t("$vuetify.msg.noNotes")))])])],1):r("v-layout",[e._v("\n    <"),r("v-progress-circular",{attrs:{indeterminate:"",color:"primary",size:200,width:20}})],1)],1)},staticRenderFns:[]};var C=r("VU/8")({data:function(){return{}},computed:{myNotes:function(){return this.$store.getters.myNotes},defaultImageSrc:function(){return this.$store.getters.defaultImageSrc}}},N,!1,function(e){r("kLwD")},"data-v-432fee0f",null).exports,I={data:function(){return{title:"",description:"",text:"",isPrivate:!1,image:null,imageSrc:"",encode:!1,key:"",valid:!1}},computed:{loading:function(){return this.$store.getters.loading}},methods:{createNote:function(){var e=this;if(this.$refs.form.validate()){var t={title:this.title,description:this.description,text:this.text,isPrivate:this.isPrivate,image:this.image,key:this.key};this.$store.dispatch("createNote",t).then(function(){return e.$router.push("/")}).catch()}},triggerUpload:function(){this.$refs.fileInput.click()},onFileChange:function(e){var t=this,r=e.target.files[0],n=new FileReader;n.onload=function(){t.imageSrc=n.result},n.readAsDataURL(r),this.image=r}}},P={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",[r("v-layout",{attrs:{row:""}},[r("v-flex",{attrs:{xs12:"",sm10:"","offset-sm1":"",md8:"","offset-md2":"",lg6:"","offset-lg3":""}},[r("h1",{staticClass:"text--secondary pa-2"},[e._v(e._s(e.$vuetify.t("$vuetify.form.newNote")))]),e._v(" "),r("v-form",{ref:"form",staticClass:"pa-2",attrs:{validation:""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[r("v-text-field",{attrs:{name:"title",label:e.$vuetify.t("$vuetify.field.title"),type:"text"},model:{value:e.title,callback:function(t){e.title=t},expression:"title"}}),e._v(" "),r("v-textarea",{attrs:{name:"description",label:e.$vuetify.t("$vuetify.field.description"),type:"text"},model:{value:e.description,callback:function(t){e.description=t},expression:"description"}}),e._v(" "),r("v-textarea",{attrs:{name:"text",label:e.$vuetify.t("$vuetify.field.text"),type:"text"},model:{value:e.text,callback:function(t){e.text=t},expression:"text"}})],1),e._v(" "),r("v-btn",{staticClass:"white--text mb-3",attrs:{color:"primary"},on:{click:e.triggerUpload}},[e._v("\n        "+e._s(e.$vuetify.t("$vuetify.btn.uploadPreview"))+"\n        "),r("v-icon",{attrs:{right:"",dark:""}},[e._v("cloud_upload")])],1),e._v(" "),r("input",{ref:"fileInput",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*"},on:{change:e.onFileChange}}),e._v(" "),e.imageSrc?r("img",{attrs:{src:e.imageSrc,alt:"",height:"150"}}):e._e(),e._v(" "),r("v-switch",{staticClass:"pa-2",attrs:{label:e.$vuetify.t("$vuetify.field.isPrivate"),color:"primary"},model:{value:e.isPrivate,callback:function(t){e.isPrivate=t},expression:"isPrivate"}}),e._v(" "),r("v-switch",{staticClass:"pa-2",attrs:{label:e.$vuetify.t("$vuetify.field.encode"),color:"primary"},model:{value:e.encode,callback:function(t){e.encode=t},expression:"encode"}}),e._v(" "),e.encode?r("v-text-field",{staticClass:"pa-2",attrs:{name:"key",label:e.$vuetify.t("$vuetify.field.encodeKey"),type:"text"},model:{value:e.key,callback:function(t){e.key=t},expression:"key"}}):e._e(),e._v(" "),r("v-spacer"),e._v(" "),r("v-btn",{staticClass:"white--text",attrs:{color:"primary",disabled:!e.valid||e.loading,loading:e.loading},on:{click:e.createNote}},[e._v(e._s(e.$vuetify.t("$vuetify.btn.create")))])],1)],1)],1)},staticRenderFns:[]};var U=r("VU/8")(I,P,!1,function(e){r("uyTF")},"data-v-3032f816",null).exports,T={data:function(){var e=this;return{email:"",password:"",emailRules:[function(t){return!!t||e.$vuetify.t("$vuetify.rules.emailRequired")},function(t){return/.+@.+/.test(t)||e.$vuetify.t("$vuetify.rules.emailValid")}],passwordRules:[function(t){return!!t||e.$vuetify.t("$vuetify.rules.passwordRequired")},function(t){return t&&t.length>=6||e.$vuetify.t("$vuetify.rules.passwordLength")}],valid:!0}},computed:{loading:function(){return this.$store.getters.loading}},methods:{onSubmit:function(){var e=this;if(this.$refs.form.validate()){var t={email:this.email,password:this.password};this.$store.dispatch("loginUser",t).then(function(){return e.$router.push("/")}).catch(function(e){return window.console.error(e)})}}},created:function(){this.$route.query.loginError&&this.$store.dispatch("setError","Please log in to access this page")}},R={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",{attrs:{fluid:"","fill-height":""}},[r("v-layout",{attrs:{"align-center":"","justify-center":""}},[r("v-flex",{attrs:{xs12:"",sm8:"",md6:"",lg4:"",xl3:""}},[r("v-card",{staticClass:"elevation-12"},[r("v-toolbar",{attrs:{dark:"",color:"primary"}},[r("v-toolbar-title",[e._v(e._s(e.$vuetify.t("$vuetify.form.login")))])],1),e._v(" "),r("v-card-text",[r("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[r("v-text-field",{attrs:{"prepend-icon":"person",name:"email",label:e.$vuetify.t("$vuetify.field.email"),type:"email",rules:e.emailRules},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),e._v(" "),r("v-text-field",{attrs:{"prepend-icon":"lock",name:"password",label:e.$vuetify.t("$vuetify.field.password"),type:"password",rules:e.passwordRules},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1)],1),e._v(" "),r("v-card-actions",[r("v-spacer"),e._v(" "),r("v-btn",{attrs:{color:"primary",disabled:!e.valid||e.loading,loading:e.loading},on:{click:e.onSubmit}},[e._v(e._s(e.$vuetify.t("$vuetify.btn.login")))])],1)],1)],1)],1)],1)},staticRenderFns:[]};var D=r("VU/8")(T,R,!1,function(e){r("ldTB")},"data-v-38f4d121",null).exports,A={data:function(){var e=this;return{email:"",nickname:"",password:"",confirmPassword:"",emailRules:[function(t){return!!t||e.$vuetify.t("$vuetify.rules.emailRequired")},function(t){return/.+@.+/.test(t)||e.$vuetify.t("$vuetify.rules.emailValid")}],image:null,imageSrc:"",nicknameRules:[function(t){return!!t||e.$vuetify.t("$vuetify.rules.nicknameRequired")},function(t){return t&&t.length>=4||e.$vuetify.t("$vuetify.rules.nicknameLength")}],passwordRules:[function(t){return!!t||e.$vuetify.t("$vuetify.rules.passwordRequired")},function(t){return t&&t.length>=6||e.$vuetify.t("$vuetify.rules.passwordLength")}],confirmPasswordRules:[function(t){return!!t||e.$vuetify.t("$vuetify.rules.passwordRequired")},function(t){return t===e.password||e.$vuetify.t("$vuetify.rules.passwordMatch")}],valid:!0,validNickname:!0,step:""}},computed:{loading:function(){return this.$store.getters.loading}},methods:{onCompleteFirstStep:function(){var e=this;this.$refs.form.validate()&&this.$store.dispatch("checkOnAvailable",{field:"username",value:this.email}).then(function(){e.step=2}).catch(function(){})},onCompleteSecondStep:function(){var e=this;this.$refs.formNickname.validate()&&this.$store.dispatch("checkOnAvailable",{field:"nickname",value:this.nickname}).then(function(){e.step=3}).catch(function(){})},onSubmit:function(){var e=this,t={email:this.email,password:this.password,nickname:this.nickname,image:this.image};this.$store.dispatch("registerUser",t).then(function(){return e.$router.push("/")}).catch(function(){})},triggerUpload:function(){this.$refs.fileInput.click()},onFileChange:function(e){var t=this,r=e.target.files[0],n=new FileReader;n.onload=function(){t.imageSrc=n.result},n.readAsDataURL(r),this.image=r}}},F={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",{attrs:{fluid:"","fill-height":""}},[r("v-layout",{attrs:{"align-center":"","justify-center":""}},[r("v-flex",{attrs:{xs12:"",sm8:"",md6:"",lg5:"",xl4:""}},[r("v-stepper",{attrs:{"alt-labels":""},model:{value:e.step,callback:function(t){e.step=t},expression:"step"}},[r("v-stepper-header",[r("v-stepper-step",{attrs:{complete:e.step>1,step:"1"}},[e._v(e._s(e.$vuetify.t("$vuetify.regStep.step1")))]),e._v(" "),r("v-divider"),e._v(" "),r("v-stepper-step",{attrs:{complete:e.step>2,step:"2"}},[e._v(e._s(e.$vuetify.t("$vuetify.regStep.step2")))]),e._v(" "),r("v-divider"),e._v(" "),r("v-stepper-step",{attrs:{step:"3"}},[e._v(e._s(e.$vuetify.t("$vuetify.regStep.step3")))])],1),e._v(" "),r("v-stepper-items",[r("v-stepper-content",{attrs:{step:"1"}},[r("v-card",[r("v-card-text",[r("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[r("v-text-field",{attrs:{"prepend-icon":"person",name:"email",label:e.$vuetify.t("$vuetify.field.email"),type:"email",rules:e.emailRules},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),e._v(" "),r("v-text-field",{attrs:{"prepend-icon":"lock",name:"password",label:e.$vuetify.t("$vuetify.field.password"),type:"password",rules:e.passwordRules},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),e._v(" "),r("v-text-field",{attrs:{"prepend-icon":"lock",name:"confirm-password",label:e.$vuetify.t("$vuetify.field.confirmPassword"),type:"password",rules:e.confirmPasswordRules},model:{value:e.confirmPassword,callback:function(t){e.confirmPassword=t},expression:"confirmPassword"}})],1)],1),e._v(" "),r("v-card-actions",[r("v-spacer"),e._v(" "),r("v-btn",{attrs:{color:"primary",loading:e.loading,disabled:!e.valid||e.loading},on:{click:e.onCompleteFirstStep}},[e._v("\n                  "+e._s(e.$vuetify.t("$vuetify.btn.continue"))+"\n                ")])],1)],1)],1),e._v(" "),r("v-stepper-content",{attrs:{step:"2"}},[r("v-card",[r("v-card-text",[r("v-form",{ref:"formNickname",attrs:{"lazy-validation":""},model:{value:e.validNickname,callback:function(t){e.validNickname=t},expression:"validNickname"}},[r("v-text-field",{attrs:{"prepend-icon":"person",name:"nickname",label:e.$vuetify.t("$vuetify.field.nickname"),type:"text",rules:e.nicknameRules},model:{value:e.nickname,callback:function(t){e.nickname=t},expression:"nickname"}})],1)],1),e._v(" "),r("v-card-actions",[r("v-spacer"),e._v(" "),r("v-btn",{attrs:{color:"primary",loading:e.loading,disabled:!e.validNickname||e.loading},on:{click:e.onCompleteSecondStep}},[e._v("\n                  "+e._s(e.$vuetify.t("$vuetify.btn.continue"))+"\n                ")])],1)],1)],1),e._v(" "),r("v-stepper-content",{attrs:{step:"3"}},[r("v-card",[e.imageSrc?r("v-img",{attrs:{src:e.imageSrc}}):e._e(),e._v(" "),r("v-btn",{staticClass:"white--text mb-3",attrs:{color:"primary"},on:{click:e.triggerUpload}},[e._v(e._s(e.$vuetify.t("$vuetify.btn.uploadAvatar"))+"\n                "),r("v-icon",{attrs:{right:"",dark:""}},[e._v("cloud_upload")])],1),e._v(" "),r("input",{ref:"fileInput",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*"},on:{change:e.onFileChange}}),e._v(" "),r("v-card-actions",[r("v-spacer"),e._v(" "),r("v-btn",{attrs:{color:"primary",loading:e.loading,disabled:!e.validNickname||e.loading},on:{click:e.onSubmit}},[e._v("\n                  "+e._s(e.$vuetify.t("$vuetify.btn.submit"))+"\n                ")])],1)],1)],1)],1)],1)],1)],1)],1)},staticRenderFns:[]};var O=r("VU/8")(A,F,!1,function(e){r("3ihA")},"data-v-514571da",null).exports,M={data:function(){var e=this;return{valid:!0,nicknameRules:[function(t){return!!t||e.$vuetify.t("$vuetify.rules.nicknameRequired")},function(t){return t&&t.length>=4||e.$vuetify.t("$vuetify.rules.nicknameLength")}],image:null,imageSrc:""}},computed:{user:function(){return this.$store.getters.user},loading:function(){return this.$store.getters.loading}},methods:{onSubmit:function(){var e=this,t={nickname:this.editedNickname,image:this.image};this.$store.dispatch("updateUserData",t).then(function(){return e.$router.push("/")}).catch(function(){})},triggerUpload:function(){this.$refs.fileInput.click()},onFileChange:function(e){var t=this,r=e.target.files[0],n=new FileReader;n.onload=function(){t.imageSrc=n.result},n.readAsDataURL(r),this.image=r}},created:function(){this.editedNickname=this.user.nickname}},q={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",[r("v-layout",{attrs:{"justify-center":"",row:""}},[r("v-flex",{attrs:{xs12:"",sm10:"",md:"",8:"",lg6:""}},[e.loading?r("v-flex",{staticClass:"text-xs-center",attrs:{xs12:""}},[r("v-progress-circular",{attrs:{size:150,color:"primary",indeterminate:""}})],1):r("v-card",[e.imageSrc||e.user.avatarSrc?r("v-img",{attrs:{src:e.imageSrc||e.user.avatarSrc}}):e._e(),e._v(" "),r("v-btn",{staticClass:"white--text mb-3",attrs:{color:"primary"},on:{click:e.triggerUpload}},[e._v(e._s(e.$vuetify.t("$vuetify.btn.uploadAvatar"))+"\n          "),r("v-icon",{attrs:{right:"",dark:""}},[e._v("cloud_upload")])],1),e._v(" "),r("input",{ref:"fileInput",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*"},on:{change:e.onFileChange}}),e._v(" "),r("v-card-text",{staticStyle:{"word-wrap":"break-word"}},[r("v-form",{ref:"form",model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[r("v-text-field",{attrs:{name:"nickname",label:e.$vuetify.t("$vuetify.field.nickname"),type:"text",rules:e.nicknameRules},model:{value:e.editedNickname,callback:function(t){e.editedNickname=t},expression:"editedNickname"}})],1)],1),e._v(" "),r("v-card-actions",[r("v-spacer"),e._v(" "),r("v-btn",{staticClass:"white--text",attrs:{raised:"",color:"primary",loading:e.loading,disabled:!e.valid||e.loading},on:{click:e.onSubmit}},[e._v(e._s(e.$vuetify.t("$vuetify.btn.save")))])],1)],1)],1)],1)],1)},staticRenderFns:[]};var V=r("VU/8")(M,q,!1,function(e){r("9pHl")},"data-v-5cd90871",null).exports,K={data:function(){return{isConnected:!1,message:"",messages:[],footerHeight:"60px",onInputKeyFlag:!1,key:""}},computed:{user:function(){return this.$store.getters.user}},sockets:{connect:function(){this.isConnected=!0},disconnect:function(){this.isConnected=!1},MESSAGE:function(e){var t=e;if(t.date=new Date(t.createAt),-1!==t.message.indexOf("U2FsdGVkX1")){if(!(this.key.length>0))return;t.message=b.decode(e.message,this.key)}t.message.length>0&&this.messages.push(t)}},methods:{pingServer:function(){this.$socket.emit("pingServer","PING!")},sendMessage:function(){if(this.message.length>0){this.key.length>0&&(this.message=b.encode(this.message,this.key));var e=new Date;this.$socket.emit("SEND_MESSAGE",{createAt:e.getTime(),user:this.user.nickname,message:this.message,avatarSrc:this.user.avatarSrc}),this.message=""}},inputKey:function(){this.onInputKeyFlag=!this.onInputKeyFlag,this.onInputKeyFlag?this.footerHeight="120px":this.footerHeight="60px"},isAMultyMsg:function(e){return!(e<1)&&this.messages[e].user===this.messages[e-1].user}},updated:function(){if(window.pageYOffset){var e=document.body.offsetHeight-document.documentElement.clientHeight;window.scrollTo(0,e)}}},G={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",[e._l(e.messages,function(t,n){return r("v-layout",{key:t.createAt,attrs:{"justify-center":""}},[r("v-flex",{attrs:{xs12:"",sm10:"",md8:"",lg6:""}},[r("v-card",{attrs:{flat:"",tile:""}},[r("v-layout",{attrs:{row:""}},[r("v-flex",{attrs:{xs2:"",sm1:"",md1:"",lg1:""}},[e.isAMultyMsg(n)?e._e():r("v-avatar",{staticStyle:{"min-width":"50px"},attrs:{size:"50px",color:"grey lighten-4"}},[r("v-img",{attrs:{src:t.avatarSrc,alt:"avatar"}})],1)],1),e._v(" "),r("v-flex",{attrs:{xs10:"",sm11:"",md11:""}},[r("v-card-text",{staticClass:"pa-1 ma-0",staticStyle:{"word-wrap":"break-word"}},[e.isAMultyMsg(n)?e._e():r("span",{staticClass:"subheading primary--text font-weight-bold"},[e._v(e._s(t.user))]),e._v(" "),e.isAMultyMsg(n)?e._e():r("span",{staticClass:"secondary--text"},[e._v(e._s(t.date.getHours())+":"+e._s(t.date.getMinutes()))]),e._v(" "),r("p",{staticClass:"pa-0 ma-0"},[e._v(e._s(t.message))])])],1)],1)],1)],1)],1)}),e._v(" "),r("v-footer",{attrs:{app:"",height:e.footerHeight,color:"white"}},[r("v-layout",{attrs:{row:"",wrap:"","justify-center":""}},[r("v-flex",{attrs:{xs12:"",sm10:"",md8:"",lg6:"","pa-5":""}},[r("v-text-field",{attrs:{"append-outer-icon":"send","append-icon":"vpn_key",clearable:"",label:e.$vuetify.t("$vuetify.field.message"),type:"text"},on:{"click:append-outer":e.sendMessage,"click:append":e.inputKey,keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.sendMessage(t):null}},model:{value:e.message,callback:function(t){e.message=t},expression:"message"}}),e._v(" "),e.onInputKeyFlag?r("v-text-field",{staticClass:"mr-4",attrs:{label:"Key",type:"text"},model:{value:e.key,callback:function(t){e.key=t},expression:"key"}}):e._e()],1)],1)],1)],2)},staticRenderFns:[]};var z=r("VU/8")(K,G,!1,function(e){r("p2Ga")},"data-v-4fcf5b68",null).exports,j={mounted:function(){for(var e=document.getElementById("myCanvas"),t=e.getContext("2d"),r=e.width/2,n=e.height-30,i=2,a=-2,s=10,o="#0095DD",c=0,l=3,u=10,d=75,v=(e.width-d)/2,f=!1,p=!1,m=3,h=5,g=75,y=20,k=10,w=30,x=30,_=[],$=0;$<h;$++){_[$]=[];for(var b=0;b<m;b++)_[$][b]={x:0,y:0,status:1}}document.addEventListener("keydown",function(e){39===e.keyCode?f=!0:37===e.keyCode&&(p=!0)},!1),document.addEventListener("keyup",function(e){39===e.keyCode?f=!1:37===e.keyCode&&(p=!1)},!1),document.addEventListener("mousemove",function(t){var r=t.clientX-e.offsetLeft;r>0&&r<e.width&&(v=r-d/2)},!1),function $(){t.clearRect(0,0,e.width,e.height),t.beginPath(),t.arc(r,n,s,0,2*Math.PI),t.fillStyle=o,t.fill(),t.closePath(),t.beginPath(),t.rect(v,e.height-u,d,u),t.fillStyle="#0095DD",t.fill(),t.closePath(),function(){for(var e=0;e<h;e++)for(var r=0;r<m;r++)if(1===_[e][r].status){var n=e*(g+k)+x,i=r*(y+k)+w;_[e][r].x=n,_[e][r].y=i,t.beginPath(),t.rect(n,i,g,y),t.fillStyle="#0095DD",t.fill(),t.closePath()}}(),t.font="16px Arial",t.fillStyle="#0095DD",t.fillText("Score: "+c,8,20),t.font="16px Arial",t.fillStyle="#0095DD",t.fillText("Lives: "+l,e.width-65,20),function(){for(var e=0;e<h;e++)for(var t=0;t<m;t++){var s=_[e][t];1===s.status&&r>s.x&&r<s.x+g&&n>s.y&&n<s.y+y&&(a=-a,s.status=0,i*=1.05,a*=1.05,++c==m*h&&(alert("YOU WIN, CONGRATULATIONS!"),document.location.reload()))}}(),r+=i,n+=a,requestAnimationFrame($),(r+i>e.width-s||r+i<s)&&(i=-i),n+a<s?a=-a:n+a>e.height-s&&(r>v&&r<v+d?a=-a:--l?(r=e.width/2,n=e.height-30,i=2,a=-2,v=(e.width-d)/2):(alert("GAME OVER"),document.location.reload())),f&&v<e.width-d?v+=7:p&&v>0&&(v-=7)}()}},H={render:function(){var e=this.$createElement,t=this._self._c||e;return t("v-container",[t("h1",[this._v("Game")]),this._v(" "),t("canvas",{attrs:{id:"myCanvas",width:"480",height:"320",app:""}})])},staticRenderFns:[]};var W=r("VU/8")(j,H,!1,function(e){r("GUKl")},"data-v-018fd5d0",null).exports,B=function(e,t,r){localStorage.getItem("user-token")?r():r("/login?loginError=true")};n.default.use(f.a);var X=new f.a({routes:[{path:"",name:"home",component:m},{path:"/note/:id",name:"note",component:L,props:!0},{path:"/list",name:"list",component:C,beforeEnter:B},{path:"/new",name:"newNote",component:U,beforeEnter:B},{path:"/login",name:"login",component:D},{path:"/registration",name:"registration",component:O},{path:"/user",name:"profile",component:V,beforeEnter:B},{path:"/chat",name:"chat",component:z,beforeEnter:B},{path:"/game",name:"game",component:W}],mode:"history"}),Q=r("NYxO"),Y=r("Xxa5"),Z=r.n(Y),J=r("Dd8w"),ee=r.n(J),te=r("exGp"),re=r.n(te),ne=r("mtWM"),ie=r.n(ne),ae=function e(t,r,n,i){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments[5],o=arguments[6];k()(this,e),this.title=t,this.description=r,this.text=n,this.authorId=i,this.isPrivate=a,this.id=s,this.imageSrc=o},se={state:{notes:[],defaultImageSrc:"https://st2.depositphotos.com/1496410/5390/v/950/depositphotos_53905395-stock-illustration-small-memo-with-pin.jpg"},mutations:{createNote:function(e,t){e.notes.push(t)},loadNotes:function(e,t){e.notes=t},updateNote:function(e,t){var r=e.notes.find(function(e){return e.id===t.id});r.title=t.title,r.description=t.description,r.text=t.text,r.isPrivate=t.isPrivate},deleteNote:function(e,t){var r=e.notes.find(function(e){return e.id===t.id}),n=e.notes.indexOf(r);e.notes.splice(n,1)}},actions:{createNote:function(e,t){var r=this,n=e.commit,i=e.getters,a=e.dispatch;return re()(Z.a.mark(function e(){var s,o,c,l,u;return Z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n("clearError"),n("setLoading",!0),s=t.image,o=void 0,e.prev=4,!s){e.next=9;break}return e.next=8,a("loadImage",{image:s});case 8:o=e.sent;case 9:return c=new ae(t.title,t.description,t.text,i.user.id,t.isPrivate,t.id,o),t.key.length>0&&(c.text=b.encode(c.text,t.key)),window.console.log(c),e.next=14,ie.a.post("/api/note/new",c);case 14:l=e.sent,u=l.data,n("createNote",ee()({},c,{id:u.note._id})),n("setLoading",!1),e.next=25;break;case 20:throw e.prev=20,e.t0=e.catch(4),n("setError",e.t0.message),n("setLoading",!1),e.t0;case 25:case"end":return e.stop()}},e,r,[[4,20]])}))()},updateNote:function(e,t){var r=this,n=e.commit;e.getters;return re()(Z.a.mark(function e(){return Z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n("clearError"),n("setLoading",!0),e.prev=2,e.next=5,ie.a.put("/api/note/"+t.id,ee()({},t));case 5:n("updateNote",{title:t.title,description:t.description,id:t.id,isPrivate:t.isPrivate}),n("setLoading",!1),e.next=14;break;case 9:throw e.prev=9,e.t0=e.catch(2),n("setError",e.t0.message),n("setLoading",!1),e.t0;case 14:case"end":return e.stop()}},e,r,[[2,9]])}))()},fetchNotes:function(e){var t=this,r=e.commit;return re()(Z.a.mark(function e(){var n,i,a;return Z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r("clearError"),r("setLoading",!0),e.prev=2,e.next=5,ie.a.get("/api/note/list");case 5:n=e.sent,i=n.data,a=[],i.forEach(function(e){a.push(new ae(e.title,e.description,e.text,e.authorId,e.isPrivate,e._id,e.imageSrc))}),r("loadNotes",a),r("setLoading",!1),e.next=18;break;case 13:throw e.prev=13,e.t0=e.catch(2),r("setError",e.t0.message),r("setLoading",!1),e.t0;case 18:case"end":return e.stop()}},e,t,[[2,13]])}))()},deleteNote:function(e,t){var r=this,n=e.commit;e.getters;return re()(Z.a.mark(function e(){return Z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n("clearError"),n("setLoading",!0),e.prev=2,e.next=5,ie.a.delete("/api/note/"+t.id);case 5:n("deleteNote",{id:t.id}),n("setLoading",!1),e.next=14;break;case 9:throw e.prev=9,e.t0=e.catch(2),n("setError",e.t0.message),n("setLoading",!1),e.t0;case 14:case"end":return e.stop()}},e,r,[[2,9]])}))()},loadImage:function(e,t){var r=this,n=e.commit;return re()(Z.a.mark(function e(){var i,a,s,o,c;return Z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n("clearError"),n("setLoading",!0),i=t.image,a=void 0,e.prev=4,(s=new FormData).append("file",i),e.next=9,ie.a.post("/api/note/image",s);case 9:return o=e.sent,c=o.data,window.console.log(c),a=ie.a.defaults.baseURL+"/api/note/image/"+c.id,n("setLoading",!1),e.abrupt("return",a);case 17:throw e.prev=17,e.t0=e.catch(4),n("setError",e.t0.message),n("setLoading",!1),e.t0;case 22:case"end":return e.stop()}},e,r,[[4,17]])}))()},updateImage:function(e,t){var r=this,n=e.commit;return re()(Z.a.mark(function e(){var i,a,s,o,c;return Z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n("clearError"),n("setLoading",!0),i=t.image,a=t.imageSrc.replace(ie.a.defaults.baseURL,"/"),e.prev=4,(s=new FormData).append("file",i),e.next=9,ie.a.put(a,s);case 9:return o=e.sent,c=o.data,window.console.log(c),n("setLoading",!1),e.abrupt("return",a);case 16:throw e.prev=16,e.t0=e.catch(4),n("setError",e.t0.message),n("setLoading",!1),e.t0;case 21:case"end":return e.stop()}},e,r,[[4,16]])}))()}},getters:{defaultImageSrc:function(e){return e.defaultImageSrc},notes:function(e){return e.notes},publicNotes:function(e){return e.notes.filter(function(e){return!e.isPrivate})},myNotes:function(e,t){return e.notes.filter(function(e){return e.authorId===t.user.id})},notesWithPreview:function(e){return e.notes.filter(function(e){return!!e.imageSrc&&!e.isPrivate})},noteById:function(e){return function(t){return e.notes.find(function(e){return e.id===t})}}}},oe=function e(t){k()(this,e),window.console.log("CREATE USER"),window.console.log(t),this.token=t.token,this.refreshToken=t.refreshToken,window.console.log(this.refreshToken),this.id=t.id,this.email=t.username,this.nickname=t.nickname,this.avatarSrc=t.avatarSrc,localStorage.setItem("user-refreshToken",t.refreshToken),localStorage.setItem("user-token",t.token)},ce={state:{user:null},mutations:{setUser:function(e,t){e.user=t},updateUser:function(e,t){e.user.nickname=t.nickname||e.user.nickname,e.user.avatarSrc=t.avatarSrc||e.user.avatarSrc,e.user.email=t.username||e.user.email,e.user.id=t.id||e.user.id},updateTokens:function(e,t){e.user.token=t.token,e.user.refreshToken=t.refreshToken}},actions:{registerUser:function(e,t){var r=this,n=e.commit,i=e.dispatch;return re()(Z.a.mark(function e(){var a,s,o,c;return Z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n("clearError"),n("setLoading",!0),a=t.image,s=void 0,e.prev=4,!a){e.next=9;break}return e.next=8,i("loadImage",{image:a});case 8:s=e.sent;case 9:return e.next=11,ie.a.post("/api/signup",{username:t.email,password:t.password,nickname:t.nickname,avatarSrc:s});case 11:o=e.sent,c=o.data,n("setUser",new oe(c)),n("setLoading",!1),e.next=22;break;case 17:throw e.prev=17,e.t0=e.catch(4),n("setLoading",!1),n("setError",e.t0.response.data.message),e.t0;case 22:case"end":return e.stop()}},e,r,[[4,17]])}))()},updateUserData:function(e,t){var r=this,n=e.commit,i=e.dispatch,a=e.getters;return re()(Z.a.mark(function e(){var s,o,c,l;return Z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n("clearError"),n("setLoading",!0),s=t.image,o=a.user.avatarSrc,e.prev=4,!s){e.next=8;break}return e.next=8,i("updateImage",{image:s,imageSrc:o});case 8:return window.console.log("updateUserData"),window.console.log(t.nickname),e.next=12,ie.a.put("/api/user",{nickname:t.nickname});case 12:c=e.sent,l=c.data,n("updateUser",l),n("setLoading",!1),e.next=23;break;case 18:throw e.prev=18,e.t0=e.catch(4),n("setLoading",!1),n("setError",e.t0.response.data.message),e.t0;case 23:case"end":return e.stop()}},e,r,[[4,18]])}))()},loginUser:function(e,t){var r=this,n=e.commit;return re()(Z.a.mark(function e(){var i,a;return Z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n("clearError"),n("setLoading",!0),e.prev=2,e.next=5,ie.a.post("/api/login",{username:t.email,password:t.password});case 5:i=e.sent,a=i.data,window.console.log(a),n("setUser",new oe(a)),n("setLoading",!1),e.next=17;break;case 12:throw e.prev=12,e.t0=e.catch(2),n("setLoading",!1),n("setError",e.t0.response.data.message),e.t0;case 17:case"end":return e.stop()}},e,r,[[2,12]])}))()},autoLoginUser:function(e,t){var r=this,n=e.commit;return re()(Z.a.mark(function e(){var i,a;return Z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n("setUser",new oe(t)),n("clearError"),n("setLoading",!0),e.prev=3,window.console.log("AUTOLOGIN1"),e.next=7,ie.a.get("/api/user/");case 7:i=e.sent,a=i.data,window.console.log(a),window.console.log("AUTOLOGIN"),n("updateUser",a),n("setLoading",!1),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(3),n("setLoading",!1),n("setError",e.t0.response.data.message);case 19:case"end":return e.stop()}},e,r,[[3,15]])}))()},logoutUser:function(e){var t=this,r=e.commit,n=e.getters;return re()(Z.a.mark(function e(){return Z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return localStorage.removeItem("user-token"),localStorage.removeItem("user-refreshToken"),e.prev=2,e.next=5,ie.a.post("/api/logout",{refreshToken:n.user.refreshToken});case 5:r("setUser",null),e.next=12;break;case 8:throw e.prev=8,e.t0=e.catch(2),r("setUser",null),e.t0;case 12:case"end":return e.stop()}},e,t,[[2,8]])}))()},checkOnAvailable:function(e,t){var r=this,n=e.commit;return re()(Z.a.mark(function e(){var i,a;return Z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n("clearError"),n("setLoading",!0),e.prev=2,e.next=5,ie.a.post("/api/check",{field:t.field,value:t.value});case 5:if(i=e.sent,a=i.data,window.console.log(a),a.isAvailable){e.next=10;break}throw new Error("This "+t.field+" are not available");case 10:return n("setLoading",!1),e.abrupt("return",a.isAvailable);case 14:throw e.prev=14,e.t0=e.catch(2),n("setLoading",!1),n("setError",e.t0.message),e.t0;case 19:case"end":return e.stop()}},e,r,[[2,14]])}))()}},getters:{user:function(e){return e.user},token:function(e){return e.user?e.user.token:null},refreshToken:function(e){return e.user?e.user.refreshToken:null},isUserLoggedIn:function(e){return null!==e.user}}};n.default.use(Q.a);var le=new Q.a.Store({modules:{notes:se,user:ce,shared:{state:{loading:!1,error:null},mutations:{setLoading:function(e,t){e.loading=t},setError:function(e,t){e.error=t},clearError:function(e){e.error=null}},actions:{setLoading:function(e,t){(0,e.commit)("setLoading",t)},setError:function(e,t){(0,e.commit)("setError",t)},clearError:function(e){(0,e.commit)("clearError")}},getters:{loading:function(e){return e.loading},error:function(e){return e.error}}},chat:{state:{},mutations:{},actions:{},getters:{}}}}),ue="https://notes-manager.herokuapp.com",de=r("//Fk"),ve=r.n(de),fe=this;(function(){var e;ie.a.defaults.baseURL=ue,ie.a.interceptors.request.use(function(e){var t=le.getters.token;if(!t)return e;var r=ee()({headers:{}},e);return r.headers.Authorization="Bearer "+t,window.console.log("INTERCEPTOR ON REQUEST"),r},function(e){ve.a.reject(e)}),ie.a.interceptors.response.use(function(e){return e},(e=re()(Z.a.mark(function e(t){var r,n,i,a,s;return Z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((r=le.getters.refreshToken)&&401===t.response.status&&!t.config.retry){e.next=3;break}throw t;case 3:return(n=void 0)||(n=ie.a.post("/api/refresh",{refreshToken:r}),window.console.log("AXIOS CONFIG"),window.console.log(r)),e.next=7,n;case 7:return i=e.sent,a=i.data,window.console.log("INTERCEPTORS ON RESPONSE"),a&&(window.console.log("AXIOS data"),window.console.log(a),le.commit("updateTokens",a),localStorage.setItem("user-refreshToken",a.refreshToken),localStorage.setItem("user-token",a.token)),s=ee()({},t.config,{retry:!0}),window.console.log(s),e.abrupt("return",ie()(s));case 14:case"end":return e.stop()}},e,fe)})),function(t){return e.apply(this,arguments)}))})();var pe=o()(ue);n.default.use(l.a,pe,le),n.default.use(a.a,{lang:{locales:{en:{appName:"Note manager",navLinks:{profile:"Profile",newNote:"New note",myNotes:"My notes",chat:"Chat",registration:"Registration",login:"Login",logout:"Logout"},btn:{open:"Open",save:"Save",continue:"Continue",uploadAvatar:"Upload avatar",uploadPreview:"Upload preview",decodeQ:"Decode?",decode:"Decode!",submit:"Submit!",login:"Login",delete:"Delete",edit:"Edit",cancel:"Cancel",create:"Create"},rules:{nicknameRequired:"Nickname is required",nicknameLength:"Nickname must be equal or more than 4 characters",emailRequired:"E-mail is required",emailValid:"E-mail must be valid",passwordRequired:"Password is required",passwordLength:"Password must be equal or more than 6 characters",passwordMatch:"Password should match"},field:{nickname:"Nickname",email:"Email",password:"Password",confirmPassword:"Confirm password",keyForDecode:"Key for decode note",title:"Title",description:"Description",text:"Note text",isPrivate:"Note is private?",encode:"Encode this note?",encodeKey:"Key for encode note",message:"Enter message"},regStep:{step1:"Create account",step2:"Enter your nickname",step3:"Download your avatar"},form:{login:"Login form",editNote:"Edit note",newNote:"Create New Note"},msg:{noNotes:"You have no notes"}},ru:{appName:"Менеджер заметок",navLinks:{profile:"Профиль",newNote:"Новая заметка",myNotes:"Мои заметки",chat:"Чат",registration:"Регистрация",login:"Войти",logout:"Выйти"},btn:{open:"Открыть",save:"Сохранить",continue:"Продолжить",uploadAvatar:"Загрузить аватар",uploadPreview:"Загрузить картинку",decodeQ:"Расшифровать?",decode:"Расшифровать!",submit:"Зарегистрироваться!",login:"Войти",delete:"Удалить",edit:"Редактировать",cancel:"Отмена",create:"Создать"},rules:{nicknameRequired:"Введите имя пользователя",nicknameLength:"Имя пользователя должно состоять из 4 символов или больше",emailRequired:"Введите емейл",emailValid:"Емейл не верен",passwordRequired:"Введите пароль",passwordLength:"Пароль должен состоять из 6 символов или больше",passwordMatch:"Пароли не совпадают"},field:{nickname:"Имя пользователя",email:"Емейл",password:"Пароль",confirmPassword:"Подтвердите пароль",keyForDecode:"Ключ для расшифровки заметки",title:"Заголовок",description:"Описание",text:"Текст заметки",isPrivate:"Эта заметка доступна всем ?",encode:"Зашифровать эту заметку?",encodeKey:"Ключ для шифрования",message:"Введите сообщение"},regStep:{step1:"Создайте аккаунт",step2:"Выберите имя пользователя",step3:"Загрузите аватар"},form:{login:"Форма входа",editNote:"Редактировать заметку",newNote:"Создать новую заметку"},msg:{noNotes:"У Вас нет заметок"}}},current:"en"},theme:{primary:"#4c75a3",secondary:"#b0bec5",accent:"#8c9eff",error:"#b71c1c"}}),n.default.config.productionTip=!1,new n.default({el:"#app",store:le,router:X,components:{App:v},template:"<App/>",created:function(){var e={};e.refreshToken=localStorage.getItem("user-refreshToken"),e.token=localStorage.getItem("user-token"),e.refreshToken&&this.$store.dispatch("autoLoginUser",e).then().catch(),this.$store.dispatch("fetchNotes")}})},QSs0:function(e,t){},kLwD:function(e,t){},ldTB:function(e,t){},p2Ga:function(e,t){},uyTF:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.c5266c5cd81e2d320bbe.js.map