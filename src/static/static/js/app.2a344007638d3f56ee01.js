webpackJsonp([1],{0:function(e,t){},"0Gvo":function(e,t){},"5cAG":function(e,t){},"5jLB":function(e,t){},"7zck":function(e,t){},"8c5A":function(e,t){},NHnr:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("7+uW"),n=r("3EgV"),s=r.n(n),i=r("DmT9"),o=r.n(i),c=r("hMcO"),l=r.n(c),d=(r("7zck"),{render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-app",[r("v-navigation-drawer",{attrs:{app:"",temporary:""},model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[r("v-list",[e._l(e.links,function(t){return r("v-list-tile",{key:t.title,attrs:{to:t.url}},[r("v-list-tile-action",[r("v-icon",[e._v(e._s(t.icon))])],1),e._v(" "),r("v-list-tile-content",[r("v-list-tile-title",{domProps:{textContent:e._s(t.title)}}),e._v(" "),"Profile"===t.title?r("v-list-tile-sub-title",{domProps:{textContent:e._s(e.user.email)}}):e._e()],1)],1)}),e._v(" "),e.isUserLoggedIn?r("v-list-tile",{on:{click:e.onLogout}},[r("v-list-tile-action",[r("v-icon",[e._v("exit_to_app")])],1),e._v(" "),r("v-list-tile-content",[r("v-list-tile-title",{domProps:{textContent:e._s("Logout")}})],1)],1):e._e()],2)],1),e._v(" "),r("v-toolbar",{attrs:{app:"",dark:"",color:"primary"}},[r("v-toolbar-side-icon",{staticClass:"hidden-md-and-up",on:{click:function(t){e.drawer=!e.drawer}}}),e._v(" "),r("v-toolbar-title",[r("router-link",{staticClass:"pointer",attrs:{to:"/",tag:"span"}},[e._v("Note manager")])],1),e._v(" "),r("v-spacer"),e._v(" "),r("v-toolbar-items",{staticClass:"hidden-sm-and-down"},[e._l(e.links,function(t){return r("v-btn",{key:t.title,attrs:{flat:"",to:t.url}},[r("v-icon",{attrs:{left:""}},[e._v(e._s(t.icon))]),e._v("\n        "+e._s(t.title))],1)}),e._v(" "),e.isUserLoggedIn?r("v-btn",{attrs:{flat:""},on:{click:e.onLogout}},[r("v-icon",{attrs:{left:""}},[e._v("exit_to_app")]),e._v("\n        Logout\n      ")],1):e._e()],2)],1),e._v(" "),r("v-content",[r("router-view")],1),e._v(" "),e.error?[r("v-snackbar",{attrs:{"multi-line":!0,timeout:5e3,color:"error",value:!0},on:{input:e.closeError}},[e._v("\n      "+e._s(e.error)+"\n      "),r("v-btn",{attrs:{dark:"",flat:""},nativeOn:{click:function(t){return e.closeError(t)}}},[e._v("Close")])],1)]:e._e()],2)},staticRenderFns:[]});var u=r("VU/8")({data:function(){return{drawer:!1}},computed:{error:function(){return this.$store.getters.error},isUserLoggedIn:function(){return this.$store.getters.isUserLoggedIn},user:function(){return this.$store.getters.user},links:function(){return this.isUserLoggedIn?[{title:"Profile",icon:"account_box",url:"/user"},{title:"New note",icon:"note_add",url:"/new"},{title:"My notes",icon:"list",url:"/list"},{title:"Chat",icon:"chat",url:"/chat"}]:[{title:"Registration",icon:"face",url:"/registration"},{title:"Login",icon:"lock",url:"/login"}]}},methods:{closeError:function(){this.$store.dispatch("clearError")},onLogout:function(){this.$store.dispatch("logoutUser"),this.$router.push("/")}}},d,!1,function(e){r("s7k4")},"data-v-187575a8",null).exports,v=r("/ocq"),p={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.loading?r("div",[r("v-container",[r("v-layout",{attrs:{row:""}},[r("v-flex",{staticClass:"text-xs-center",attrs:{xs12:""}},[r("v-progress-circular",{attrs:{size:150,color:"primary",indeterminate:""}})],1)],1)],1)],1):r("div",[e.notesWithPreview.length>0?r("v-container",{attrs:{fluid:""}},[r("v-layout",{attrs:{row:""}},[r("v-flex",{attrs:{xs12:""}},[r("v-carousel",e._l(e.notesWithPreview,function(t){return r("v-carousel-item",{key:t.id,attrs:{src:t.imageSrc},on:{click:function(r){e.onClickCarausel(t.id)}}})}))],1)],1)],1):e._e(),e._v(" "),r("v-container",{attrs:{"grid-list-lg":""}},[r("v-layout",{attrs:{row:"",wrap:""}},e._l(e.publicNotes,function(t){return r("v-flex",{key:t.id,attrs:{xs12:"",sm6:"",md4:"",lg4:"",xl3:""}},[r("v-card",[r("v-img",{attrs:{src:t.imageSrc||e.defaultImageSrc,height:"200px"}}),e._v(" "),r("v-card-text",{staticStyle:{"word-wrap":"break-word"}},[r("div",[r("h3",{staticClass:"headline mb-0"},[e._v(e._s(t.title))]),e._v(" "),r("div",[e._v(e._s(t.description))])])]),e._v(" "),r("v-card-actions",[r("v-spacer"),e._v(" "),r("v-btn",{attrs:{flat:""}},[e._v("Share")]),e._v(" "),r("v-btn",{staticClass:"primary",attrs:{raised:"",to:"/note/"+t.id}},[e._v("Open")])],1)],1)],1)}))],1)],1)},staticRenderFns:[]};var m=r("VU/8")({data:function(){return{}},computed:{notesWithPreview:function(){return this.$store.getters.notesWithPreview},publicNotes:function(){return this.$store.getters.publicNotes},defaultImageSrc:function(){return this.$store.getters.defaultImageSrc},loading:function(){return this.$store.getters.loading}},methods:{onClickCarausel:function(e){this.$router.push("/note/"+e)}}},p,!1,function(e){r("0Gvo")},"data-v-2222fb42",null).exports,f={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-dialog",{attrs:{"max-width":"1500px"},model:{value:e.modal,callback:function(t){e.modal=t},expression:"modal"}},[r("v-btn",{staticClass:"primary",attrs:{slot:"activator"},slot:"activator"},[e._v("Edit")]),e._v(" "),r("v-card",[r("v-container",[r("v-layout",{attrs:{row:""}},[r("v-flex",{attrs:{xs12:"",lg10:"","offset-lg1":""}},[r("v-card-title",[r("h1",{staticClass:"text--primary"},[e._v("Edit note")])]),e._v(" "),r("v-form",{ref:"form",staticClass:"pa-3 pt-4",model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[r("v-text-field",{attrs:{name:"title",label:"Title",type:"text"},model:{value:e.editedTitle,callback:function(t){e.editedTitle=t},expression:"editedTitle"}}),e._v(" "),r("v-textarea",{attrs:{name:"description",label:"Description",type:"text","auto-grow":"",rows:"3"},model:{value:e.editedDescription,callback:function(t){e.editedDescription=t},expression:"editedDescription"}}),e._v(" "),r("v-textarea",{attrs:{name:"text",label:"Note text",type:"text",rows:"10"},model:{value:e.editedText,callback:function(t){e.editedText=t},expression:"editedText"}}),e._v(" "),r("v-switch",{attrs:{label:"Note is private?",color:"primary"},model:{value:e.editedIsPrivate,callback:function(t){e.editedIsPrivate=t},expression:"editedIsPrivate"}})],1),e._v(" "),r("v-card-actions",[r("v-spacer"),e._v(" "),r("v-btn",{attrs:{flat:""},on:{click:e.onCancel}},[e._v("Cancel")]),e._v(" "),r("v-btn",{staticClass:"white--text",attrs:{raised:"",color:"primary",disabled:!e.valid||e.loading,loading:e.loading},on:{click:e.onSave}},[e._v("Save")])],1)],1)],1)],1)],1)],1)},staticRenderFns:[]};var h=r("VU/8")({data:function(){return{modal:!1,editedTitle:this.note.title,editedDescription:this.note.description,editedText:this.note.text,editedIsPrivate:this.note.isPrivate,valid:!1}},methods:{onCancel:function(){this.editedTitle=this.note.title,this.editedDescription=this.note.description,this.editedText=this.note.text,this.editedIsPrivate=this.note.isPrivate,this.modal=!1},onSave:function(){var e=this;this.$store.dispatch("updateNote",{title:this.editedTitle,description:this.editedDescription,text:this.editedText,isPrivate:this.editedIsPrivate,id:this.note.id}).then(function(){e.modal=!1}).catch(function(){})}},props:["note"],computed:{loading:function(){return this.$store.getters.loading}}},f,!1,function(e){r("YGxT")},"data-v-f6880270",null).exports,g=r("Zrlr"),x=r.n(g),k=r("wxAW"),w=r.n(k),_=r("Av7u"),y=r.n(_),b=function(){function e(){x()(this,e)}return w()(e,null,[{key:"encode",value:function(e,t){return y.a.AES.encrypt(e,t).toString()}},{key:"decode",value:function(e,t){return y.a.AES.decrypt(e,t).toString(y.a.enc.Utf8)}}]),e}(),S={props:["id"],data:function(){return{decode:!1,key:"",decodedText:""}},computed:{note:function(){var e=this.id;window.console.log(e);var t=this.$store.getters.noteById(e);return t||(this.$store.dispatch("setError","a note was not found or insufficient access rights"),{})},defaultImageSrc:function(){return this.$store.getters.defaultImageSrc},loading:function(){return this.$store.getters.loading},user:function(){return this.$store.getters.user},text:function(){return this.note.text?(window.console.log(this.note),this.decodedText.length>0?this.decodedText:this.note.text.length>20&&-1===this.note.text.indexOf(" ")?"This text are encoded":this.note.text):""}},methods:{onDelete:function(){this.$store.dispatch("deleteNote",{id:this.note.id}).then(function(){}).catch(function(){}),this.$router.push("/list")},onDecode:function(){0===this.key.length?(this.decode=!this.decode,this.decodedText=""):(this.decode=!this.decode,this.decodedText=b.decode(this.note.text,this.key))}},components:{appEditNoteModal:h}},E={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",[e.note?r("v-layout",{attrs:{row:""}},[r("v-flex",{attrs:{xs12:"",sm6:"","offset-sm3":""}},[e.loading?r("v-flex",{staticClass:"text-xs-center",attrs:{xs12:""}},[r("v-progress-circular",{attrs:{size:150,color:"primary",indeterminate:""}})],1):r("v-card",[e.note.imageSrc?r("v-img",{attrs:{src:e.note.imageSrc,height:"300px"}}):e._e(),e._v(" "),r("v-card-text",{staticStyle:{"word-wrap":"break-word"}},[r("h1",{staticClass:"text--primary py-3"},[e._v(e._s(e.note.title))]),e._v(" "),r("v-divider"),e._v(" "),r("h2",[e._v(e._s(e.note.description))]),e._v(" "),r("v-divider"),e._v(" "),r("p",[e._v(e._s(e.text))])],1),e._v(" "),r("v-card-actions",{attrs:{"pa-5":""}},[r("v-spacer"),e._v(" "),r("v-btn",{attrs:{flat:""},on:{click:e.onDecode}},[e._v(e._s(e.decode?"Decode !":"Decode ?"))]),e._v(" "),e.user&&e.note.authorId===e.user.id?r("v-btn",{staticClass:"warning",attrs:{flat:""},on:{click:e.onDelete}},[e._v("Delete")]):e._e(),e._v(" "),e.user&&e.note.authorId===e.user.id?r("app-edit-note-modal",{attrs:{note:e.note}}):e._e()],1),e._v(" "),r("v-layout",{attrs:{"justify-end":""}},[r("v-flex",{attrs:{xs12:"",sm6:""}},[e.decode?r("v-text-field",{staticClass:"pa-0 ma-0",attrs:{clearable:"",name:"key",label:"Key for encode note",type:"text"},model:{value:e.key,callback:function(t){e.key=t},expression:"key"}}):e._e()],1)],1)],1)],1)],1):r("v-layout",{attrs:{row:""}},[r("v-flex",{staticClass:"text-xs-center",attrs:{xs12:""}},[r("v-progress-circular",{attrs:{indeterminate:"",color:"primary",size:200,width:20}})],1)],1)],1)},staticRenderFns:[]};var C=r("VU/8")(S,E,!1,function(e){r("5jLB")},"data-v-e3bc2aa8",null).exports,N={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",{attrs:{"grid-list-lg":""}},[r("v-layout",[r("v-flex",[r("h1",{staticClass:"text--secondary mb-3"},[e._v("My notes")])])],1),e._v(" "),0!==e.myNotes.length?r("v-layout",{attrs:{row:"",wrap:""}},e._l(e.myNotes,function(t){return r("v-flex",{key:t.id,attrs:{xs12:"",sm6:"",md5:"",lg4:"",xl4:"","mb-3":""}},[r("v-card",[r("v-layout",{attrs:{row:""}},[r("v-flex",{attrs:{xs4:""}},[r("v-img",{attrs:{src:t.imageSrc||e.defaultImageSrc,height:"150px"}})],1),e._v(" "),r("v-flex",{attrs:{xs8:""}},[r("v-card-text",{staticStyle:{"word-wrap":"break-word"}},[r("h2",[e._v(" "+e._s(t.title||"Empty title"))]),e._v(" "),r("p",[e._v(e._s(t.description||"Empty description"))])]),e._v(" "),r("v-card-actions",[r("v-spacer"),e._v(" "),r("v-btn",{staticClass:"white--text",attrs:{color:"primary",to:"/note/"+t.id}},[e._v("Open")])],1)],1)],1)],1)],1)})):0===e.myNotes.length?r("v-layout",[r("v-flex",{staticClass:"text-xs-center",attrs:{xs12:""}},[r("h1",{staticClass:"text--primary"},[e._v("You have no notes")])])],1):r("v-layout",[e._v("\n    <"),r("v-progress-circular",{attrs:{indeterminate:"",color:"primary",size:200,width:20}})],1)],1)},staticRenderFns:[]};var I=r("VU/8")({data:function(){return{}},computed:{myNotes:function(){return this.$store.getters.myNotes},defaultImageSrc:function(){return this.$store.getters.defaultImageSrc}}},N,!1,function(e){r("8c5A")},"data-v-7eb9ad3e",null).exports,L={data:function(){return{title:"",description:"",text:"",isPrivate:!1,image:null,imageSrc:"",encode:!1,key:"",valid:!1}},computed:{loading:function(){return this.$store.getters.loading}},methods:{createNote:function(){var e=this;if(this.$refs.form.validate()){var t={title:this.title,description:this.description,text:this.text,isPrivate:this.isPrivate,image:this.image,key:this.key};this.$store.dispatch("createNote",t).then(function(){return e.$router.push("/")}).catch()}},triggerUpload:function(){this.$refs.fileInput.click()},onFileChange:function(e){var t=this,r=e.target.files[0],a=new FileReader;a.onload=function(){t.imageSrc=a.result},a.readAsDataURL(r),this.image=r}}},$={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",[r("v-layout",{attrs:{row:""}},[r("v-flex",{attrs:{xs12:"",sm10:"","offset-sm1":"",md8:"","offset-md2":"",lg6:"","offset-lg3":""}},[r("h1",{staticClass:"text--secondary pa-2"},[e._v("Create New Note")]),e._v(" "),r("v-form",{ref:"form",staticClass:"pa-2",attrs:{validation:""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[r("v-text-field",{attrs:{name:"title",label:"Note title",type:"text"},model:{value:e.title,callback:function(t){e.title=t},expression:"title"}}),e._v(" "),r("v-textarea",{attrs:{name:"description",label:"Note description",type:"text"},model:{value:e.description,callback:function(t){e.description=t},expression:"description"}}),e._v(" "),r("v-textarea",{attrs:{name:"text",label:"Note text",type:"text"},model:{value:e.text,callback:function(t){e.text=t},expression:"text"}})],1),e._v(" "),r("v-btn",{staticClass:"white--text mb-3",attrs:{color:"primary"},on:{click:e.triggerUpload}},[e._v("Upload preview\n        "),r("v-icon",{attrs:{right:"",dark:""}},[e._v("cloud_upload")])],1),e._v(" "),r("input",{ref:"fileInput",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*"},on:{change:e.onFileChange}}),e._v(" "),e.imageSrc?r("img",{attrs:{src:e.imageSrc,alt:"",height:"150"}}):e._e(),e._v(" "),r("v-switch",{staticClass:"pa-2",attrs:{label:"Add to private?",color:"primary"},model:{value:e.isPrivate,callback:function(t){e.isPrivate=t},expression:"isPrivate"}}),e._v(" "),r("v-switch",{staticClass:"pa-2",attrs:{label:"Encode this note?",color:"primary"},model:{value:e.encode,callback:function(t){e.encode=t},expression:"encode"}}),e._v(" "),e.encode?r("v-text-field",{staticClass:"pa-2",attrs:{name:"key",label:"Key for encode note",type:"text"},model:{value:e.key,callback:function(t){e.key=t},expression:"key"}}):e._e(),e._v(" "),r("v-spacer"),e._v(" "),r("v-btn",{staticClass:"white--text",attrs:{color:"primary",disabled:!e.valid||e.loading,loading:e.loading},on:{click:e.createNote}},[e._v("Create Note")])],1)],1)],1)},staticRenderFns:[]};var U=r("VU/8")(L,$,!1,function(e){r("hXgm")},"data-v-0aa93fcb",null).exports,T={data:function(){return{email:"",password:"",emailRules:[function(e){return!!e||"E-mail is required"},function(e){return/.+@.+/.test(e)||"E-mail must be valid"}],passwordRules:[function(e){return!!e||"Password is required"},function(e){return e&&e.length>=6||"Password must be equal or more than 6 characters"}],valid:!0}},computed:{loading:function(){return this.$store.getters.loading}},methods:{onSubmit:function(){var e=this;if(this.$refs.form.validate()){var t={email:this.email,password:this.password};this.$store.dispatch("loginUser",t).then(function(){return e.$router.push("/")}).catch(function(e){return window.console.error(e)})}}},created:function(){this.$route.query.loginError&&this.$store.dispatch("setError","Please log in to access this page")}},P={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",{attrs:{fluid:"","fill-height":""}},[r("v-layout",{attrs:{"align-center":"","justify-center":""}},[r("v-flex",{attrs:{xs12:"",sm8:"",md6:"",lg4:"",xl3:""}},[r("v-card",{staticClass:"elevation-12"},[r("v-toolbar",{attrs:{dark:"",color:"primary"}},[r("v-toolbar-title",[e._v("Login form")])],1),e._v(" "),r("v-card-text",[r("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[r("v-text-field",{attrs:{"prepend-icon":"person",name:"email",label:"Email",type:"email",rules:e.emailRules},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),e._v(" "),r("v-text-field",{attrs:{"prepend-icon":"lock",name:"password",label:"Password",type:"password",rules:e.passwordRules},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1)],1),e._v(" "),r("v-card-actions",[r("v-spacer"),e._v(" "),r("v-btn",{attrs:{color:"primary",disabled:!e.valid||e.loading,loading:e.loading},on:{click:e.onSubmit}},[e._v("Login")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var R=r("VU/8")(T,P,!1,function(e){r("e7kl")},"data-v-0a03329e",null).exports,A={data:function(){var e=this;return{email:"",nickname:"",password:"",confirmPassword:"",emailRules:[function(e){return!!e||"E-mail is required"},function(e){return/.+@.+/.test(e)||"E-mail must be valid"}],image:null,imageSrc:"",nicknameRules:[function(e){return!!e||"Nickname is required"},function(e){return e&&e.length>=4||"Nickname must be equal or more than 4 characters"}],passwordRules:[function(e){return!!e||"Password is required"},function(e){return e&&e.length>=6||"Password must be equal or more than 6 characters"}],confirmPasswordRules:[function(e){return!!e||"Password is required"},function(t){return t===e.password||"Password should match"}],valid:!0,validNickname:!0,step:""}},computed:{loading:function(){return this.$store.getters.loading}},methods:{onCompleteFirstStep:function(){var e=this;this.$refs.form.validate()&&this.$store.dispatch("checkOnAvailable",{field:"username",value:this.email}).then(function(){e.step=2}).catch(function(){})},onCompleteSecondStep:function(){var e=this;this.$refs.formNickname.validate()&&this.$store.dispatch("checkOnAvailable",{field:"nickname",value:this.nickname}).then(function(){e.step=3}).catch(function(){})},onSubmit:function(){var e=this,t={email:this.email,password:this.password,nickname:this.nickname,image:this.image};this.$store.dispatch("registerUser",t).then(function(){return e.$router.push("/")}).catch(function(){})},triggerUpload:function(){this.$refs.fileInput.click()},onFileChange:function(e){var t=this,r=e.target.files[0],a=new FileReader;a.onload=function(){t.imageSrc=a.result},a.readAsDataURL(r),this.image=r}}},D={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",{attrs:{fluid:"","fill-height":""}},[r("v-layout",{attrs:{"align-center":"","justify-center":""}},[r("v-flex",{attrs:{xs12:"",sm8:"",md6:"",lg5:"",xl4:""}},[r("v-stepper",{attrs:{"alt-labels":""},model:{value:e.step,callback:function(t){e.step=t},expression:"step"}},[r("v-stepper-header",[r("v-stepper-step",{attrs:{complete:e.step>1,step:"1"}},[e._v("Create account")]),e._v(" "),r("v-divider"),e._v(" "),r("v-stepper-step",{attrs:{complete:e.step>2,step:"2"}},[e._v("Enter your nickname")]),e._v(" "),r("v-divider"),e._v(" "),r("v-stepper-step",{attrs:{step:"3"}},[e._v("Download your avatar")])],1),e._v(" "),r("v-stepper-items",[r("v-stepper-content",{attrs:{step:"1"}},[r("v-card",[r("v-card-text",[r("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[r("v-text-field",{attrs:{"prepend-icon":"person",name:"email",label:"Email",type:"email",rules:e.emailRules},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),e._v(" "),r("v-text-field",{attrs:{"prepend-icon":"lock",name:"password",label:"Password",type:"password",rules:e.passwordRules},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),e._v(" "),r("v-text-field",{attrs:{"prepend-icon":"lock",name:"confirm-password",label:"Confirm password",type:"password",rules:e.confirmPasswordRules},model:{value:e.confirmPassword,callback:function(t){e.confirmPassword=t},expression:"confirmPassword"}})],1)],1),e._v(" "),r("v-card-actions",[r("v-spacer"),e._v(" "),r("v-btn",{attrs:{color:"primary",loading:e.loading,disabled:!e.valid||e.loading},on:{click:e.onCompleteFirstStep}},[e._v("\n                  Continue\n                ")])],1)],1)],1),e._v(" "),r("v-stepper-content",{attrs:{step:"2"}},[r("v-card",[r("v-card-text",[r("v-form",{ref:"formNickname",attrs:{"lazy-validation":""},model:{value:e.validNickname,callback:function(t){e.validNickname=t},expression:"validNickname"}},[r("v-text-field",{attrs:{"prepend-icon":"person",name:"nickname",label:"Nickname",type:"text",rules:e.nicknameRules},model:{value:e.nickname,callback:function(t){e.nickname=t},expression:"nickname"}})],1)],1),e._v(" "),r("v-card-actions",[r("v-spacer"),e._v(" "),r("v-btn",{attrs:{color:"primary",loading:e.loading,disabled:!e.validNickname||e.loading},on:{click:e.onCompleteSecondStep}},[e._v("\n                  Continue\n                ")])],1)],1)],1),e._v(" "),r("v-stepper-content",{attrs:{step:"3"}},[r("v-card",[e.imageSrc?r("v-img",{attrs:{src:e.imageSrc}}):e._e(),e._v(" "),r("v-btn",{staticClass:"white--text mb-3",attrs:{color:"primary"},on:{click:e.triggerUpload}},[e._v("Upload avatar\n                "),r("v-icon",{attrs:{right:"",dark:""}},[e._v("cloud_upload")])],1),e._v(" "),r("input",{ref:"fileInput",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*"},on:{change:e.onFileChange}}),e._v(" "),r("v-card-actions",[r("v-spacer"),e._v(" "),r("v-btn",{attrs:{color:"primary",loading:e.loading,disabled:!e.validNickname||e.loading},on:{click:e.onSubmit}},[e._v("\n                  Submit!\n                ")])],1)],1)],1)],1)],1)],1)],1)],1)},staticRenderFns:[]};var F=r("VU/8")(A,D,!1,function(e){r("5cAG")},"data-v-7dc4e4ad",null).exports,O={data:function(){return{valid:!0,nicknameRules:[function(e){return!!e||"Nickname is required"},function(e){return e&&e.length>=4||"Nickname must be equal or more than 4 characters"}],image:null,imageSrc:""}},computed:{user:function(){return window.console.log("COMPUTED"),this.$store.getters.user},loading:function(){return this.$store.getters.loading}},methods:{onSubmit:function(){var e=this,t={nickname:this.editedNickname,image:this.image};this.$store.dispatch("updateUserData",t).then(function(){return e.$router.push("/")}).catch(function(){})},triggerUpload:function(){this.$refs.fileInput.click()},onFileChange:function(e){var t=this,r=e.target.files[0],a=new FileReader;a.onload=function(){t.imageSrc=a.result},a.readAsDataURL(r),this.image=r}},created:function(){this.editedNickname=this.user.nickname}},M={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",[r("v-layout",{attrs:{"justify-center":"",row:""}},[r("v-flex",{attrs:{xs12:"",sm10:"",md:"",8:"",lg6:""}},[e.loading?r("v-flex",{staticClass:"text-xs-center",attrs:{xs12:""}},[r("v-progress-circular",{attrs:{size:150,color:"primary",indeterminate:""}})],1):r("v-card",[e.imageSrc||e.user.avatarSrc?r("v-img",{attrs:{src:e.imageSrc||e.user.avatarSrc}}):e._e(),e._v(" "),r("v-btn",{staticClass:"white--text mb-3",attrs:{color:"primary"},on:{click:e.triggerUpload}},[e._v("Upload avatar\n          "),r("v-icon",{attrs:{right:"",dark:""}},[e._v("cloud_upload")])],1),e._v(" "),r("input",{ref:"fileInput",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*"},on:{change:e.onFileChange}}),e._v(" "),r("v-card-text",{staticStyle:{"word-wrap":"break-word"}},[r("v-form",{ref:"form",staticClass:"pa-3 pt-4",model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[r("v-text-field",{attrs:{name:"nickname",label:"Nickname",type:"text",rules:e.nicknameRules},model:{value:e.editedNickname,callback:function(t){e.editedNickname=t},expression:"editedNickname"}})],1)],1),e._v(" "),r("v-card-actions",{attrs:{"pa-5":""}},[r("v-spacer"),e._v(" "),r("v-btn",{staticClass:"white--text",attrs:{raised:"",color:"primary",loading:e.loading,disabled:!e.valid||e.loading},on:{click:e.onSubmit}},[e._v("Save")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var q=r("VU/8")(O,M,!1,function(e){r("OiOi")},"data-v-a85baa2a",null).exports,z={data:function(){return{isConnected:!1,message:"",messages:[],footerHeight:"60px",onInputKeyFlag:!1,key:""}},computed:{user:function(){return this.$store.getters.user}},sockets:{connect:function(){this.isConnected=!0},disconnect:function(){this.isConnected=!1},MESSAGE:function(e){var t=e;if(t.date=new Date(t.createAt),-1!==t.message.indexOf("U2FsdGVkX1")){if(!(this.key.length>0))return;t.message=b.decode(e.message,this.key)}t.message.length>0&&this.messages.push(t)}},methods:{pingServer:function(){this.$socket.emit("pingServer","PING!")},sendMessage:function(){if(this.message.length>0){this.key.length>0&&(this.message=b.encode(this.message,this.key));var e=new Date;this.$socket.emit("SEND_MESSAGE",{createAt:e.getTime(),user:this.user.nickname,message:this.message,avatarSrc:this.user.avatarSrc}),this.message=""}},inputKey:function(){this.onInputKeyFlag=!this.onInputKeyFlag,this.onInputKeyFlag?this.footerHeight="120px":this.footerHeight="60px"},isAMultyMsg:function(e){return!(e<1)&&this.messages[e].user===this.messages[e-1].user}},updated:function(){if(window.pageYOffset){var e=document.body.offsetHeight-document.documentElement.clientHeight;window.scrollTo(0,e)}}},G={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",[e._l(e.messages,function(t,a){return r("v-layout",{key:t.createAt,attrs:{"justify-center":""}},[r("v-flex",{attrs:{xs12:"",sm10:"",md8:"",lg6:""}},[r("v-card",{attrs:{flat:"",tile:""}},[r("v-layout",{attrs:{row:""}},[r("v-flex",{attrs:{xs2:"",sm1:"",md1:"",lg1:""}},[e.isAMultyMsg(a)?e._e():r("v-avatar",{staticStyle:{"min-width":"50px"},attrs:{size:"50px",color:"grey lighten-4"}},[r("v-img",{attrs:{src:t.avatarSrc,alt:"avatar"}})],1)],1),e._v(" "),r("v-flex",{attrs:{xs10:"",sm11:"",md11:""}},[r("v-card-text",{staticClass:"pa-1 ma-0",staticStyle:{"word-wrap":"break-word"}},[e.isAMultyMsg(a)?e._e():r("span",{staticClass:"subheading primary--text font-weight-bold"},[e._v(e._s(t.user))]),e._v(" "),e.isAMultyMsg(a)?e._e():r("span",{staticClass:"secondary--text"},[e._v(e._s(t.date.getHours())+":"+e._s(t.date.getMinutes()))]),e._v(" "),r("p",{staticClass:"pa-0 ma-0"},[e._v(e._s(t.message))])])],1)],1)],1)],1)],1)}),e._v(" "),r("v-footer",{attrs:{app:"",height:e.footerHeight,color:"white"}},[r("v-layout",{attrs:{row:"",wrap:"","justify-center":""}},[r("v-flex",{attrs:{xs12:"",sm10:"",md8:"",lg6:"","pa-5":""}},[r("v-text-field",{attrs:{"append-outer-icon":"send","append-icon":"vpn_key",clearable:"",label:"Message",type:"text"},on:{"click:append-outer":e.sendMessage,"click:append":e.inputKey,keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.sendMessage(t):null}},model:{value:e.message,callback:function(t){e.message=t},expression:"message"}}),e._v(" "),e.onInputKeyFlag?r("v-text-field",{staticClass:"mr-4",attrs:{label:"Key",type:"text"},model:{value:e.key,callback:function(t){e.key=t},expression:"key"}}):e._e()],1)],1)],1)],2)},staticRenderFns:[]};var V=r("VU/8")(z,G,!1,function(e){r("cz3D")},"data-v-1bfdc17d",null).exports,j=function(e,t,r){localStorage.getItem("user-token")?r():r("/login?loginError=true")};a.default.use(v.a);var K=new v.a({routes:[{path:"",name:"home",component:m},{path:"/note/:id",name:"note",component:C,props:!0},{path:"/list",name:"list",component:I,beforeEnter:j},{path:"/new",name:"newNote",component:U,beforeEnter:j},{path:"/login",name:"login",component:R},{path:"/registration",name:"registration",component:F},{path:"/user",name:"profile",component:q,beforeEnter:j},{path:"/chat",name:"chat",component:V,beforeEnter:j}],mode:"history"}),H=r("NYxO"),W=r("Xxa5"),X=r.n(W),B=r("Dd8w"),Y=r.n(B),J=r("exGp"),Q=r.n(J),Z=r("mtWM"),ee=r.n(Z),te=function e(t,r,a,n){var s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments[5],o=arguments[6];x()(this,e),this.title=t,this.description=r,this.text=a,this.authorId=n,this.isPrivate=s,this.id=i,this.imageSrc=o},re={state:{notes:[],defaultImageSrc:"https://st2.depositphotos.com/1496410/5390/v/950/depositphotos_53905395-stock-illustration-small-memo-with-pin.jpg"},mutations:{createNote:function(e,t){e.notes.push(t)},loadNotes:function(e,t){e.notes=t},updateNote:function(e,t){var r=e.notes.find(function(e){return e.id===t.id});r.title=t.title,r.description=t.description,r.text=t.text,r.isPrivate=t.isPrivate},deleteNote:function(e,t){var r=e.notes.find(function(e){return e.id===t.id}),a=e.notes.indexOf(r);e.notes.splice(a,1)}},actions:{createNote:function(e,t){var r=this,a=e.commit,n=e.getters,s=e.dispatch;return Q()(X.a.mark(function e(){var i,o,c,l,d;return X.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a("clearError"),a("setLoading",!0),i=t.image,o=void 0,e.prev=4,!i){e.next=9;break}return e.next=8,s("loadImage",{image:i});case 8:o=e.sent;case 9:return c=new te(t.title,t.description,t.text,n.user.id,t.isPrivate,t.id,o),t.key.length>0&&(c.text=b.encode(c.text,t.key)),window.console.log(c),e.next=14,ee.a.post("/api/note/new",c);case 14:l=e.sent,d=l.data,a("createNote",Y()({},c,{id:d.note._id})),a("setLoading",!1),e.next=25;break;case 20:throw e.prev=20,e.t0=e.catch(4),a("setError",e.t0.message),a("setLoading",!1),e.t0;case 25:case"end":return e.stop()}},e,r,[[4,20]])}))()},updateNote:function(e,t){var r=this,a=e.commit;e.getters;return Q()(X.a.mark(function e(){return X.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a("clearError"),a("setLoading",!0),e.prev=2,e.next=5,ee.a.put("/api/note/"+t.id,Y()({},t));case 5:a("updateNote",{title:t.title,description:t.description,id:t.id,isPrivate:t.isPrivate}),a("setLoading",!1),e.next=14;break;case 9:throw e.prev=9,e.t0=e.catch(2),a("setError",e.t0.message),a("setLoading",!1),e.t0;case 14:case"end":return e.stop()}},e,r,[[2,9]])}))()},fetchNotes:function(e){var t=this,r=e.commit;return Q()(X.a.mark(function e(){var a,n,s;return X.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r("clearError"),r("setLoading",!0),e.prev=2,e.next=5,ee.a.get("/api/note/list");case 5:a=e.sent,n=a.data,s=[],n.forEach(function(e){s.push(new te(e.title,e.description,e.text,e.authorId,e.isPrivate,e._id,e.imageSrc))}),r("loadNotes",s),r("setLoading",!1),e.next=18;break;case 13:throw e.prev=13,e.t0=e.catch(2),r("setError",e.t0.message),r("setLoading",!1),e.t0;case 18:case"end":return e.stop()}},e,t,[[2,13]])}))()},deleteNote:function(e,t){var r=this,a=e.commit;e.getters;return Q()(X.a.mark(function e(){return X.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a("clearError"),a("setLoading",!0),e.prev=2,e.next=5,ee.a.delete("/api/note/"+t.id);case 5:a("deleteNote",{id:t.id}),a("setLoading",!1),e.next=14;break;case 9:throw e.prev=9,e.t0=e.catch(2),a("setError",e.t0.message),a("setLoading",!1),e.t0;case 14:case"end":return e.stop()}},e,r,[[2,9]])}))()},loadImage:function(e,t){var r=this,a=e.commit;return Q()(X.a.mark(function e(){var n,s,i,o,c;return X.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a("clearError"),a("setLoading",!0),n=t.image,s=void 0,e.prev=4,(i=new FormData).append("file",n),e.next=9,ee.a.post("/api/note/image",i);case 9:return o=e.sent,c=o.data,window.console.log(c),s=ee.a.defaults.baseURL+"api/note/image/"+c.id,a("setLoading",!1),e.abrupt("return",s);case 17:throw e.prev=17,e.t0=e.catch(4),a("setError",e.t0.message),a("setLoading",!1),e.t0;case 22:case"end":return e.stop()}},e,r,[[4,17]])}))()},updateImage:function(e,t){var r=this,a=e.commit;return Q()(X.a.mark(function e(){var n,s,i,o,c;return X.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a("clearError"),a("setLoading",!0),n=t.image,s=t.imageSrc.replace(ee.a.defaults.baseURL,"/"),e.prev=4,(i=new FormData).append("file",n),e.next=9,ee.a.put(s,i);case 9:return o=e.sent,c=o.data,window.console.log(c),a("setLoading",!1),e.abrupt("return",s);case 16:throw e.prev=16,e.t0=e.catch(4),a("setError",e.t0.message),a("setLoading",!1),e.t0;case 21:case"end":return e.stop()}},e,r,[[4,16]])}))()}},getters:{defaultImageSrc:function(e){return e.defaultImageSrc},notes:function(e){return e.notes},publicNotes:function(e){return e.notes.filter(function(e){return!e.isPrivate})},myNotes:function(e,t){return e.notes.filter(function(e){return e.authorId===t.user.id})},notesWithPreview:function(e){return e.notes.filter(function(e){return!!e.imageSrc&&!e.isPrivate})},noteById:function(e){return function(t){return e.notes.find(function(e){return e.id===t})}}}},ae=function e(t){x()(this,e),window.console.log("CREATE USER"),window.console.log(t),this.token=t.token,this.refreshToken=t.refreshToken,window.console.log(this.refreshToken),this.id=t.id,this.email=t.username,this.nickname=t.nickname,this.avatarSrc=t.avatarSrc,localStorage.setItem("user-refreshToken",t.refreshToken),localStorage.setItem("user-token",t.token)},ne={state:{user:null},mutations:{setUser:function(e,t){e.user=t},updateUser:function(e,t){e.user.nickname=t.nickname||e.user.nickname,e.user.avatarSrc=t.avatarSrc||e.user.avatarSrc,e.user.email=t.username||e.user.email,e.user.id=t.id||e.user.id},updateTokens:function(e,t){e.user.token=t.token,e.user.refreshToken=t.refreshToken}},actions:{registerUser:function(e,t){var r=this,a=e.commit,n=e.dispatch;return Q()(X.a.mark(function e(){var s,i,o,c;return X.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a("clearError"),a("setLoading",!0),s=t.image,i=void 0,e.prev=4,!s){e.next=9;break}return e.next=8,n("loadImage",{image:s});case 8:i=e.sent;case 9:return e.next=11,ee.a.post("/api/signup",{username:t.email,password:t.password,nickname:t.nickname,avatarSrc:i});case 11:o=e.sent,c=o.data,a("setUser",new ae(c)),a("setLoading",!1),e.next=22;break;case 17:throw e.prev=17,e.t0=e.catch(4),a("setLoading",!1),a("setError",e.t0.response.data.message),e.t0;case 22:case"end":return e.stop()}},e,r,[[4,17]])}))()},updateUserData:function(e,t){var r=this,a=e.commit,n=e.dispatch,s=e.getters;return Q()(X.a.mark(function e(){var i,o,c,l;return X.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a("clearError"),a("setLoading",!0),i=t.image,o=s.user.avatarSrc,e.prev=4,!i){e.next=8;break}return e.next=8,n("updateImage",{image:i,imageSrc:o});case 8:return window.console.log("updateUserData"),window.console.log(t.nickname),e.next=12,ee.a.put("/api/user",{nickname:t.nickname});case 12:c=e.sent,l=c.data,a("updateUser",l),a("setLoading",!1),e.next=23;break;case 18:throw e.prev=18,e.t0=e.catch(4),a("setLoading",!1),a("setError",e.t0.response.data.message),e.t0;case 23:case"end":return e.stop()}},e,r,[[4,18]])}))()},loginUser:function(e,t){var r=this,a=e.commit;return Q()(X.a.mark(function e(){var n,s;return X.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a("clearError"),a("setLoading",!0),e.prev=2,e.next=5,ee.a.post("/api/login",{username:t.email,password:t.password});case 5:n=e.sent,s=n.data,window.console.log(s),a("setUser",new ae(s)),a("setLoading",!1),e.next=17;break;case 12:throw e.prev=12,e.t0=e.catch(2),a("setLoading",!1),a("setError",e.t0.response.data.message),e.t0;case 17:case"end":return e.stop()}},e,r,[[2,12]])}))()},autoLoginUser:function(e,t){var r=this,a=e.commit;return Q()(X.a.mark(function e(){var n,s;return X.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a("setUser",new ae(t)),a("clearError"),a("setLoading",!0),e.prev=3,window.console.log("AUTOLOGIN1"),e.next=7,ee.a.get("/api/user/");case 7:n=e.sent,s=n.data,window.console.log(s),window.console.log("AUTOLOGIN"),a("updateUser",s),a("setLoading",!1),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(3),a("setLoading",!1),a("setError",e.t0.response.data.message);case 19:case"end":return e.stop()}},e,r,[[3,15]])}))()},logoutUser:function(e){var t=this,r=e.commit,a=e.getters;return Q()(X.a.mark(function e(){return X.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return localStorage.removeItem("user-token"),localStorage.removeItem("user-refreshToken"),e.prev=2,e.next=5,ee.a.post("/api/logout",{refreshToken:a.user.refreshToken});case 5:r("setUser",null),e.next=12;break;case 8:throw e.prev=8,e.t0=e.catch(2),r("setUser",null),e.t0;case 12:case"end":return e.stop()}},e,t,[[2,8]])}))()},checkOnAvailable:function(e,t){var r=this,a=e.commit;return Q()(X.a.mark(function e(){var n,s;return X.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a("clearError"),a("setLoading",!0),e.prev=2,e.next=5,ee.a.post("/api/check",{field:t.field,value:t.value});case 5:if(n=e.sent,s=n.data,window.console.log(s),s.isAvailable){e.next=10;break}throw new Error("This "+t.field+" are not available");case 10:return a("setLoading",!1),e.abrupt("return",s.isAvailable);case 14:throw e.prev=14,e.t0=e.catch(2),a("setLoading",!1),a("setError",e.t0.message),e.t0;case 19:case"end":return e.stop()}},e,r,[[2,14]])}))()}},getters:{user:function(e){return e.user},token:function(e){return e.user?e.user.token:null},refreshToken:function(e){return e.user?e.user.refreshToken:null},isUserLoggedIn:function(e){return null!==e.user}}};a.default.use(H.a);var se=new H.a.Store({modules:{notes:re,user:ne,shared:{state:{loading:!1,error:null},mutations:{setLoading:function(e,t){e.loading=t},setError:function(e,t){e.error=t},clearError:function(e){e.error=null}},actions:{setLoading:function(e,t){(0,e.commit)("setLoading",t)},setError:function(e,t){(0,e.commit)("setError",t)},clearError:function(e){(0,e.commit)("clearError")}},getters:{loading:function(e){return e.loading},error:function(e){return e.error}}},chat:{state:{},mutations:{},actions:{},getters:{}}}}),ie="https://notes-manager.herokuapp.com",oe=r("//Fk"),ce=r.n(oe),le=this;(function(){var e;ee.a.defaults.baseURL=ie,ee.a.interceptors.request.use(function(e){var t=se.getters.token;if(!t)return e;var r=Y()({headers:{}},e);return r.headers.Authorization="Bearer "+t,window.console.log("INTERCEPTOR ON REQUEST"),r},function(e){ce.a.reject(e)}),ee.a.interceptors.response.use(function(e){return e},(e=Q()(X.a.mark(function e(t){var r,a,n,s,i;return X.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((r=se.getters.refreshToken)&&401===t.response.status&&!t.config.retry){e.next=3;break}throw t;case 3:return(a=void 0)||(a=ee.a.post("/api/refresh",{refreshToken:r}),window.console.log("AXIOS CONFIG"),window.console.log(r)),e.next=7,a;case 7:return n=e.sent,s=n.data,window.console.log("INTERCEPTORS ON RESPONSE"),s&&(window.console.log("AXIOS data"),window.console.log(s),se.commit("updateTokens",s),localStorage.setItem("user-refreshToken",s.refreshToken),localStorage.setItem("user-token",s.token)),i=Y()({},t.config,{retry:!0}),window.console.log(i),e.abrupt("return",ee()(i));case 14:case"end":return e.stop()}},e,le)})),function(t){return e.apply(this,arguments)}))})();var de=o()(ie);a.default.use(l.a,de,se),a.default.use(s.a,{theme:{primary:"#4c75a3",secondary:"#b0bec5",accent:"#8c9eff",error:"#b71c1c"}}),a.default.config.productionTip=!1,new a.default({el:"#app",store:se,router:K,components:{App:u},template:"<App/>",created:function(){var e={};e.refreshToken=localStorage.getItem("user-refreshToken"),e.token=localStorage.getItem("user-token"),e.refreshToken&&this.$store.dispatch("autoLoginUser",e).then().catch(),this.$store.dispatch("fetchNotes")}})},OiOi:function(e,t){},YGxT:function(e,t){},cz3D:function(e,t){},e7kl:function(e,t){},hXgm:function(e,t){},s7k4:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.2a344007638d3f56ee01.js.map